<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="../../static/css/default.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/font.css">
    <!--슬라이드-->
    <script src="./js/swiper-bundle.min.js"></script>
    <link rel="stylesheet" href="./css/swiper-bundle.min.css" />

    <!--scrollTrigger-->
    <script src="../../static/js/gsap.min.js"></script>
    <style>
        * {margin: 0; padding: 0; box-sizing: border-box;}
        body{overflow-x: hidden;}

        .mySwiper {width: 100%; aspect-ratio: 1/1.3; padding:0 10px; margin-bottom: 60px;}
        .swiper-slide {position: relative; width:80%; height: calc((100vw - 20px) * 0.8 * 1.5);}
        /*  너비 : 다음 슬라이드가 일부 보이게 하기 위해 설정
            높이 : ((100vw - 20px ) * 0.8 = 너비)   * 1.5( = 이미지 비율)
            height: calc((100vw - 20px) * 0.8 * 1.44 + 41px);
        */
        .swiper-slide .slideContent{height:100%; display: flex; justify-content:flex-start; flex-flow: column; overflow: hidden;}
        .swiper-slide .slideContent > div{position:relative; width: 100%; height:60%; left:100%; background-size: 110%; background-repeat: no-repeat;  transition: 0.5s ease-out, 0.8s 0.2s ease-out background-size;
         /* 지워도 되는 부분 → */ font-size: 4rem; color:#fff; text-align: center;
        }
        .swiper-slide .slideContent > div:before{content:''; position: absolute; display: block; width: 100%; height:100%; background:#053905; left:0; top:0; transition: 1s ease-out;}
        .mySwiper :is(.swiper-slide-active, .swiper-slide-prev) .slideContent > div {height:100%;}

        /* paging type progress*/
        .swiper-pagination{ transition : 0.5s width, 0.5s opacity;}
        .swiper-horizontal > .swiper-pagination-progressbar, .swiper-pagination-progressbar.swiper-pagination-horizontal, .swiper-pagination-progressbar.swiper-pagination-vertical.swiper-pagination-progressbar-opposite, .swiper-vertical > .swiper-pagination-progressbar.swiper-pagination-progressbar-opposite {
            height: 2px; opacity: 0; width: 0; top:auto; bottom:0;
        }
        .swiper-pagination-progressbar .swiper-pagination-progressbar-fill{background:#222;}

        /* 슬라이드 영역 viewport 노출 후 */
        .slideStart .swiper-slide .slideContent > div{left:0; background-size: 100%;}
        .slideStart .slideContent > div:before{width: 0;}
        .slideStart :is(.swiper-horizontal > .swiper-pagination-progressbar, .swiper-pagination-progressbar.swiper-pagination-horizontal, .swiper-pagination-progressbar.swiper-pagination-vertical.swiper-pagination-progressbar-opposite, .swiper-vertical > .swiper-pagination-progressbar.swiper-pagination-progressbar-opposite) {
            opacity: 1; width: 100%;
        }

        #title{width: 200vw; margin-left:-50vw; padding:0 10px;}
        .curTitle {position: relative; bottom: 10%; left:0; width: 100%; height: 1.2em; overflow: hidden; display: flex; justify-content: space-between; padding-right: 20%;}
        .curTitle.effect :is(b,span){position:relative; animation : slideEffect 0.2s ease-out forwards ,slideEffect2 0.2s 0.2s ease-out forwards ; top:auto; left:0;}

        @keyframes slideEffect {
            0% {top: 0;}
            100% {top:-100%;}
        }
        @keyframes slideEffect2 {
            0% {top: 100%;}
            100% {top:0;}
        }

    </style>
    <script src="../../static/js/ScrollTrigger.min.js"></script>
</head>
<body>
<div style="display:flex; height: 100vh; background-color:#88aae7; text-align: center; justify-content: center; align-items: center; color:#fff; font-size: 2em;">상단영역</div>
<h1 id="title">
    <span class="fl">2032 Spring</span><br>
    <span class="fr" style="font-weight: 900">LOOKBOOk</span></h1>
<!-- Slider main container -->
<div class="swiper mySwiper">
    <!-- Additional required wrapper -->
    <div class="swiper-wrapper">
        <!-- Slides -->
        <div class="swiper-slide">
            <div class="slideContent">
                <div style="background-image:url(https://picsum.photos/462/643)">1</div>
                <p class="textArea hideDesc">
                    <b>빨간원피스와 털달린 구두 컬렉션</b>
                    <span>23 S/S</span>
                </p>
            </div>
        </div>
        <div class="swiper-slide">
            <div class="slideContent">
                <div style="background-image:url(https://picsum.photos/462/643)">2</div>
                <p class="textArea hideDesc">
                    <b>노란색 트레이닝과 뾰족구두 컬렉션</b>
                    <span>23 S/S</span>
                </p>
            </div>
        </div>
        <div class="swiper-slide">
            <div class="slideContent">
                <div style="background-image:url(https://picsum.photos/462/643)">3</div>
                <p class="textArea hideDesc">
                    <b>색안경과 꽃 컬렉션</b>
                    <span>23 S/S</span>
                </p>
            </div>
        </div>
        <div class="swiper-slide">
            <div class="slideContent">
                <div style="background-image:url(https://picsum.photos/462/643)">4</div>
                <p class="textArea hideDesc">
                    <b>긴 치마와 멋진구두 컬렉션</b>
                    <span>23 S/S</span>
                </p>
            </div>
        </div>
        <div class="swiper-slide">
            <div class="slideContent">
                <div style="background-image: url(https://images.unsplash.com/flagged/photo-1559502867-c406bd78ff24?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=685&q=80)">5</div>
                <p class="textArea hideDesc">
                    <b>니트 컬렉션</b>
                    <span>23 S/S</span>
                </p>
            </div>
        </div>
    </div>
    <div class="swiper-pagination"></div>
    <div class="curTitle"><b></b><span></span></div>
</div>
<div style="display:flex; height: 100vh; background-color:#e78898; text-align: center; justify-content: center; align-items: center; color:#fff; font-size: 2em;">하단영역</div>
<script>

    let target = document.querySelector('.curTitle'); //슬라이드 제목 텍스트영역
    let cur_title1 = document.querySelectorAll('.swiper-slide')[0].querySelector('.textArea b').innerText;
    let cur_title2 = document.querySelectorAll('.swiper-slide')[0].querySelector('.textArea span').innerText;
    const swiper = new Swiper('.mySwiper', {
        loop: true,
        speed:1000, //슬라이드 넘기는 속도
        slidesPerView:'auto',
        spaceBetween:20, // 슬라이드 영역 간 여백
        pagination: {
            el: '.swiper-pagination',
            type:'progressbar'
        },
        on:{
            init:function(){
                target.children[0].innerHTML = cur_title1;
                target.children[1].innerHTML = cur_title2;
            },
            slideChangeTransitionStart : function(){
                cur_title1 = document.querySelectorAll('.swiper-slide')[this.previousIndex].querySelector('.textArea b').innerText;
                cur_title2 = document.querySelectorAll('.swiper-slide')[this.previousIndex].querySelector('.textArea span').innerText;
                target.children[0].innerHTML = cur_title1;
                target.children[1].innerHTML = cur_title2;
            },
            slideChangeTransitionEnd : function(){
                cur_title1 = document.querySelector('.swiper-slide-active').querySelector('.textArea b').innerText;
                cur_title2 = document.querySelector('.swiper-slide-active').querySelector('.textArea span').innerText;

                target.classList.remove("effect");
                void target.offsetWidth;
                target.classList.add("effect");

                setTimeout(()=>{
                    target.children[0].innerHTML = cur_title1;
                    target.children[1].innerHTML = cur_title2;
                },200)
            }
        },

        /*navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
        },
        centeredSlides : true,  // 센터로 맞춘 뒤  slidesPerView : auto,
        spaceBetween:100, // 슬라이드 영역 간 여백
        allowSlideNext:false, // 다음 슬라이드로 이동 동작 control
        allowSlidePrev:true, // 이전 슬라이드로 이동 동작 control
        initialSlide:2 //처음 보여줄 슬라이드 index 설정
        */
    });

/*    gsap.to("#title",{
       x:400,duration:2
       }
   )*/

    const tl = gsap.timeline({
        scrollTrigger:{
            trigger:'.mySwiper',
            start:'top 40%',
            markers : true,
            onEnter:()=> document.querySelector('.mySwiper').classList.add('slideStart')
        }
    })

    tl.to("#title",{width:'100vw', marginLeft : '0',duration:2})

    //swiper.slideNext(); // 다음 슬라이드로 이동시킬 수 있는 swiper instance
</script>
</body>
</html>